# Web Buddha Machine

Web Buddha Machineは、ブラウザ上で動作するインタラクティブなアンビエント・サウンド・プレイヤーです。複数のバリエーションがあり、それぞれ異なる方法でサウンドをコントロールできます。

## 📱 主な機能

### バージョンv1系（手動コントロール）
- **スライダーによる再生速度の調整**（0.25x～2.0x）
- シンプルな操作で環境音楽を楽しめます
- 3種類の異なる音源から選択可能

### バージョンv2系（GPS連動速度制御）
- **GPS位置情報を利用した自動再生速度制御**
- 初期位置からの移動距離に基づいてサイン波的に再生速度が変化
- 移動距離が15メートルを周期として0.25x～2.0xの間で変化
- 静止時（5メートル以内）は標準速度（1.0x）で再生
- リアルタイムGPS情報表示（緯度・経度・精度・距離）

### バージョンv3系（GPS連動EQ制御）
- **GPS位置情報を利用した自動イコライザー制御**
- 初期位置からの移動距離に基づいてBASSとTREBLEが切り替わる
- 移動距離15メートルを周期としてコサイン波的にBASSとTREBLEが循環
- ローパスフィルター（800Hz～18kHz）も連動して変化
- 視覚的なEQバランス表示

## 🎵 利用可能なバリエーション

各バージョンには3つの音源バリエーションが用意されています：

| バリエーション | 制御方法 | 音源 |
|--------------|---------|------|
| v1 | スライダー | デフォルト（loop.mp3） |
| v1.1 | スライダー | korogari.mp3 |
| v1.2 | スライダー | matataki.mp3 |
| v2.1 | GPS速度制御 | korogari.mp3 |
| v2.2 | GPS速度制御 | matataki.mp3 |
| v3.1 | GPS EQ制御 | korogari.mp3 |
| v3.2 | GPS EQ制御 | matataki.mp3 |

## 🚀 使い方

1. ウェブブラウザでアプリケーションにアクセス
2. 再生ボタン（▶）をクリックして音楽を開始
3. v1系：スライダーで速度を調整
4. v2/v3系：GPSアクセス許可を承認し、外を歩いてサウンドの変化を体験

### GPS機能を使用する場合の注意
- HTTPSでホストされている必要があります
- ブラウザの位置情報アクセス許可が必要です
- 屋外での使用を推奨（GPS精度向上のため）
- 移動しながら使用することで効果を最大限に楽しめます

## 💻 開発

### 必要な環境
- Node.js 18以上
- npm 9以上

### セットアップ

```bash
# リポジトリのクローン
git clone https://github.com/y1rks/web-buddha.git
cd web-buddha

# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev
```

### ビルド

```bash
# 標準ビルド
npm run build

# 全バリエーションを含むビルド
npm run build:multi
```

`build:multi`コマンドを実行すると、`dist`フォルダに全バリエーション（v1, v1.1, v1.2, v2.1, v2.2, v3.1, v3.2）が生成されます。

### プレビュー

```bash
npm run preview
```

## 🛠️ 技術スタック

- **TypeScript** - 型安全な開発
- **Vite** - 高速なビルドツール
- **Tone.js** - Web Audio APIラッパー（音声処理）
- **Geolocation API** - GPS位置情報取得

## 📐 技術的な詳細

### GPS速度制御のアルゴリズム（v2系）

```
speed = 1.125 + 0.875 × sin(2π × (distance - 5) / 15)
```

- 基準速度: 1.125x
- 振幅: 0.875
- 周期: 15メートル
- デッドゾーン: 5メートル（GPS誤差吸収）
- 速度範囲: 0.25x ～ 2.0x

### GPS EQ制御のアルゴリズム（v3系）

```
balance = cos(2π × (distance - 5) / 15)
```

- バランス範囲: -1.0（BASS）～ +1.0（TREBLE）
- LOW EQ: -15 × balance dB
- HIGH EQ: +15 × balance dB
- ローパスフィルター: 800Hz ～ 18kHz（対数スケール）
- 周期: 15メートル

### スムージング処理

GPS信号のノイズを軽減するため、指数移動平均を使用：

```
smoothedDistance = smoothedDistance × 0.7 + rawDistance × 0.3
```

## 📄 ライセンス

ISC

## 🎨 インスピレーション

このプロジェクトは、FM3の「Buddha Machine」にインスパイアされています。オリジナルのBuddhah Machineは、ループする環境音楽を再生する小型の電子デバイスです。Web版では、GPS機能を追加し、物理的な移動とサウンドの変化を連動させることで、新しい体験を提供します。
